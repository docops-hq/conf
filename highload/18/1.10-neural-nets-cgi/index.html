<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Как нейронные сети графике помогали &middot; Конспекты</title><link rel=stylesheet href=/conf/css/style.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700"><link rel=stylesheet href=/conf/custom.css><link rel=icon type=image/png sizes=32x32 href=/conf/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/conf/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/conf/images/apple-touch-icon.png><link href rel=alternate type=application/rss+xml title=Конспекты><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107215405-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-107215405-3');</script></head><body><nav class=nav><div class=nav-container><a href=/conf/><h2 class=nav-title>Конспекты</h2></a><ul><li><a href=/conf/>Posts</a></li></ul></div></nav><main><div class=post><div class=single__header><div class=post-info>Евгений Туманов (NVIDIA)</div><h1 class=post-title>Как нейронные сети графике помогали</h1><div class=post-line></div><div class=tag-block><span class=catalogue-tags><a href=/conf/tags/highload class=tags>Highload</a></span><span class=catalogue-tags><a href=/conf/tags/2018 class=tags>2018</a></span></div></div><h3 id=обзор-ml-dl-задач-в-графике>Обзор ML/DL-задач в графике</h3><p>Учителем выступает что-то “свыше” – либо из реальной жизни, либо что-то нарендеренное из движка:</p><ul><li>Создание правдоподобных анимаций</li><li>Постобработка отрендеренных изображений</li><li>Интерполяция кадров</li><li>Генерация материалов</li></ul><p>Учителем выступает какой-то алгоритм из вычислительной математики:</p><ul><li>Рендеринг сложных объектов: например, облаков</li><li>Физические симуляции</li></ul><h3 id=главная-идея>Главная идея</h3><p>Если у вас есть вычислительно сложная задача, которую вы решаете некоторым классическим вычислительным способом, попробуйте найти в этой задаче самое времязатратное место и найти решение с помощью нейронной сети или любого другого алгоритма машинного обучения.</p><p>- <em>общий рецепт как еще можно найти применение для машинного обучения</em></p><h3 id=постановка-проблемы>Постановка проблемы</h3><p>Нужно нарисовать физически корректно облако, которое представлено как плотность капелек жидкости в пространстве.</p><p><img src=../../../images/neural-nets-cgi/1-problem.png alt=1-problem></p><p>Физически сложный объект:</p><ul><li>Не твердый объект, нельзя наложить текстуру и рендерить</li><li>Капельки воды почти не поглощают свет</li><li>Они его переотражают, делают это анизотропно</li></ul><p>Рендеринг облака может занимать много часов, дни.</p><p>Художнику хочется как можно быстрее получать ответ (отрендеренное облако), чтобы иметь возможность экспериментировать с освещением сцены, топологией облака и т.п.</p><p>Нужно ускорить.</p><h3 id=классическое-решение>Классическое решение</h3><p>Сложное уравнение:</p><p><img src=../../../images/neural-nets-cgi/2-classic-solution.png alt=classic-solution></p><p>Второй терм уравнения – прямое освещение (Direct Light). Свет, который приходит от солнца, попадает на точку выхода, по вектору, который выпущен из камеры, приходит в камеру, при этом он как-то затухает, т.е. интенсивность теряется.</p><p>Первый терм – интегрирование по отрезку луча, проходящего внутри облака – опосредованное освещение (Indirect Light). Моделирует переотражение каплями света внутри облака. Интеграл I1 – это интеграл по сфере, которая окружает точку на луче. В классическом алгоритме считается с помощью Монте-Карло интегрирования.</p><p>Это самая долгая часть во всем алгоритме и самая сложная.</p><h3 id=рецепт-для-ml-алгоритма>Рецепт для ML алгоритма</h3><p>Самое тяжелое – посчитать Монте-Карло оценку. Она дает какое-то число, которое обозначает опосредованное освещение в точке.</p><p><img src=../../../images/neural-nets-cgi/3-ml-receipt.png alt=ml-receipt></p><p>Будем предсказывать Монте-Карло оценку освещения в точке – выход для ML алгоритма.</p><p>Вход:</p><ul><li>Топология плотности вокруг точки</li><li>Направление на источник</li><li>Направление на камеру (так как капли переотражают свет не изотропно)</li></ul><h3 id=обучение>Обучение</h3><p>Нужно сконструировать вход в нейронную сеть.</p><p>Первое – описать локальную плотность. Вокруг точки на отрезке луча возьмем трехмерную сетку с шагом равным длине свободного пробега в облаке. В узлах сетки – плотность облака. Увеличим шаг между узлами сетки в два раза, возьмем новую сетку, измерим плотности в её узлах. Так сделаем несколько раз.</p><p>В результате этой процедуры имеем несколько сеток, охватывающих все большую и большую окрестность вокруг точки. Такое представление оправдано, потому что мы хотим максимально подробно описывать маленькую область, и чем мы дальше от точки тем менее подробное мы хотим описание.</p><p><img src=../../../images/neural-nets-cgi/4-learning.png alt=learning></p><p>Обучать будем так: нагенерим разных облаков, будем применять классический алгоритм, записывать что он получает как ответы Монте-Карло интегрирования и фичи, на которых эти ответы были получены. Получили датасет, на котором можно обучаться.</p><h3 id=архитектура-сети>Архитектура сети</h3><p>Не является ключевой в этой задаче.</p><p>Каждая сетка попадает в блок из двух fully-connected слоев.</p><p><img src=../../../images/neural-nets-cgi/5-neural-net-architecture.png alt=neural-net-architecture></p><h3 id=результаты>Результаты</h3><p>Повышение скорости рендеринга в несколько сотен раз.</p><p>Реализация:</p><ul><li>Инструмент для рендеринга произвольных сцен, в которых есть облака</li><li>Облако задается кубом в интерфейсе Blender</li></ul><p><img src=../../../images/neural-nets-cgi/6-results.png alt=results></p></div><div class=pagination><a href=/conf/whalerider/19/investor/ class="left arrow">&#8592;</a>
<a href=/conf/knowledgeconf/19/manager-analyst-km/ class="right arrow">&#8594;</a>
<a href=# class=top>Top</a></div></main><footer><span>&copy; <time datetime="2020-07-13 11:44:29.123835773 &#43;0000 UTC m=&#43;0.139369989">2020</time> . Made with <a href=https://gohugo.io>Hugo</a> using the <a href=https://github.com/EmielH/tale-hugo/>Tale</a> theme.</span></footer></body></html>